---
phase: 10-show-schedule-management
plan: 03
type: execute
depends_on: ["10-01"]
files_modified: [src/app/shows/page.tsx, src/app/admin/page.tsx]
---

<objective>
Migrate the public shows page and admin dashboard to read show data from Supabase instead of the static data file.

Purpose: Complete the data migration so the public site reflects admin-managed content in real-time. Shows added/edited/deleted in admin immediately appear on the public page.
Output: Public shows page and admin dashboard both query Supabase for show data.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/10-show-schedule-management/10-01-SUMMARY.md

# Pages to update:
@src/app/shows/page.tsx
@src/app/admin/page.tsx

# Data sources:
@src/data/shows.ts
@src/lib/actions/shows.ts
@src/types/database.ts

**Tech stack available:** @supabase/supabase-js, @supabase/ssr, Next.js 16.1.6
**Established patterns:** Server Components with async data fetching, Supabase server client
**Constraining decisions:**
- [10-01]: Server actions provide getShows() for data fetching
- [02-03]: src/data/shows.ts also exports resultsLinks and resultsProviders — these must NOT be removed (needed for Phase 12)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update public shows page to fetch from Supabase</name>
  <files>src/app/shows/page.tsx</files>
  <action>
Update `src/app/shows/page.tsx` to query Supabase instead of importing from static data.

**Changes:**
1. Remove import of `showSchedule` from `@/data/shows` (keep `pageTitle` and `venue` imports — these are page-level constants, not per-show data)
2. Import `getShows` from `@/lib/actions/shows`
3. Make the component async: `export default async function Shows()`
4. Fetch shows at the top: `const shows = await getShows()`
5. Update the template to iterate over `shows` instead of `showSchedule`
6. Map the `ShowRow` fields to the template:
   - `show.name` → event name
   - `show.subtitle` → subtitle
   - `show.dates` → dates
   - `show.location` → location
   - `show.venue` → venue
   - `show.links` → links array (ShowLink type has same shape as EventLink: label, url, external)
   - `show.notes` → notes array
7. Handle empty state: if `shows.length === 0`, display a message like "No shows currently scheduled. Check back soon!"

**Keep unchanged:** Hero section, venue section, entry instructions section, metadata export. These are static content that doesn't come from the database.

**Important:** The `links` field from the database is typed as `ShowLink[]` which has the same {label, url, external} shape as the current `EventLink[]`. The template logic should work as-is after changing the variable name.

Do NOT remove or modify `src/data/shows.ts` — it still exports `resultsLinks` and `resultsProviders` used by the results page (Phase 12 scope). Only the `showSchedule` import changes.
  </action>
  <verify>
- Page compiles: `npx tsc --noEmit`
- Navigate to /shows — shows page renders with the 2 shows from database
- Content matches what was previously displayed from static data
- Links render correctly (external links open in new tab, internal links use Next Link)
- Notes display correctly
  </verify>
  <done>Public shows page reads from Supabase; displays same content as before; works with 0 shows (empty state) and N shows</done>
</task>

<task type="auto">
  <name>Task 2: Update admin dashboard shows count to query Supabase</name>
  <files>src/app/admin/page.tsx</files>
  <action>
Update `src/app/admin/page.tsx` to get the shows count from Supabase instead of the static array length.

**Changes:**
1. Remove import of `showSchedule` from `@/data/shows` (keep `resultsLinks` import — Phase 12 will handle results migration)
2. Import `getShows` from `@/lib/actions/shows`
3. Fetch shows: `const shows = await getShows()`
4. Update the contentCards array: change `count: showSchedule.length` to `count: shows.length`

This is a minimal change — only the data source for the shows count changes. Everything else on the dashboard stays the same.
  </action>
  <verify>
- Page compiles: `npx tsc --noEmit`
- Navigate to /admin — dashboard shows correct count matching database
- Add/delete shows in admin — dashboard count updates after navigation
  </verify>
  <done>Admin dashboard shows count reflects actual database state, not static file</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Public shows page loads from Supabase (not static file)
- [ ] Admin dashboard count matches database
- [ ] `npm run build` succeeds without errors
- [ ] No references to `showSchedule` remain in shows/page.tsx or admin/page.tsx
- [ ] `src/data/shows.ts` still exists with resultsLinks and resultsProviders intact
- [ ] Phase 10 complete — all 3 plans done
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Public shows page displays database content
- Admin dashboard reflects live counts
- Static data file preserved for results data
- Phase 10: Show Schedule Management complete
</success_criteria>

<output>
After completion, create `.planning/phases/10-show-schedule-management/10-03-SUMMARY.md`
</output>

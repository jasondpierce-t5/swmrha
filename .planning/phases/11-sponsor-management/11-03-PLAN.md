---
phase: 11-sponsor-management
plan: 03
type: execute
depends_on: ["11-01"]
files_modified: [src/app/sponsors/page.tsx, src/app/admin/page.tsx]
---

<objective>
Migrate the public sponsors page from static data to Supabase and update the admin dashboard to show live sponsor count from the database.

Purpose: Complete the data migration so sponsors are fully managed through the admin — no more static data dependency.
Output: Public sponsors page reads from Supabase, admin dashboard shows live sponsor count.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/11-sponsor-management/11-01-SUMMARY.md

# Key source files (follow migration pattern from Phase 10-03):
@src/app/shows/page.tsx
@src/app/admin/page.tsx
@src/app/sponsors/page.tsx
@src/lib/actions/sponsors.ts
@src/data/sponsors.ts

**Tech stack available:** Next.js 16, Supabase, TypeScript, Tailwind v4
**Established patterns:** getShows() Array.isArray() guard, error-resilient public pages, empty state UI, live dashboard counts
**Constraining decisions:**
- Phase 10-03: Error-resilient pattern with Array.isArray() guard for public pages
- Phase 10-03: Admin dashboard uses live database counts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate public sponsors page to Supabase data</name>
  <files>src/app/sponsors/page.tsx</files>
  <action>
Follow the exact pattern used in Phase 10-03 for migrating the public shows page.

**Replace static imports:**
- Remove: `import { sponsors, intro, signupUrl, sponsorLevels, sponsorLevelsHeading } from "@/data/sponsors"`
- Add: `import { getSponsors } from "@/lib/actions/sponsors"`
- Keep the static imports for `sponsorLevels`, `sponsorLevelsHeading`, `intro`, `signupUrl` from `@/data/sponsors` — these are tier description data, NOT individual sponsor records. Only the `sponsors` array moves to Supabase.

**Fetch sponsors from Supabase:**
```typescript
const result = await getSponsors();
const sponsors = Array.isArray(result) ? result : [];
```

**Update sponsor rendering to use SponsorRow fields:**
- `sponsor.image` → `sponsor.image_url`
- `sponsor.url` → `sponsor.website_url`
- `sponsor.level` stays the same (field name matches)
- `sponsor.name` stays the same

**Group by tier:** Keep the existing tier grouping logic but use the SponsorRow type. The tiers array and sponsorsByTier map stay the same — filter by `s.level === tier`.

**Empty state:** Add an empty state when sponsors.length === 0 (BuildingStorefrontIcon + "No sponsors listed yet" message), matching the shows page empty state pattern.

**Keep the rest of the page intact:** Hero section, sponsor tier levels section, and "Become a Sponsor" CTA all stay as-is since they use static data that doesn't need to be in the database.
  </action>
  <verify>
1. Navigate to /sponsors — page loads and shows sponsors from database
2. Sponsors are grouped by tier correctly
3. Logo images display properly
4. External links work
5. Sponsor levels section still displays correctly (static data)
  </verify>
  <done>Public sponsors page fetches from Supabase, displays sponsors by tier with logos and links, has empty state, keeps static tier descriptions intact</done>
</task>

<task type="auto">
  <name>Task 2: Update admin dashboard to show live sponsor count</name>
  <files>src/app/admin/page.tsx</files>
  <action>
Follow the exact pattern from Phase 10-03 dashboard migration.

**Replace static sponsor import:**
- Remove: `import { sponsors } from "@/data/sponsors"`
- Add: `import { getSponsors } from "@/lib/actions/sponsors"`

**Fetch live count:**
```typescript
const sponsorsResult = await getSponsors();
const sponsorsList = Array.isArray(sponsorsResult) ? sponsorsResult : [];
```

**Update the content cards:**
- Change `sponsors.length` to `sponsorsList.length` in the Sponsors card count

This is a minimal change — only the data source changes, the UI stays identical.
  </action>
  <verify>
1. Navigate to /admin — dashboard loads without errors
2. Sponsors card shows correct count matching the number of sponsors in database
3. Shows card still works (no regression)
  </verify>
  <done>Admin dashboard sponsors count fetches from Supabase instead of static data. Both shows and sponsors counts are now live database values.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Public sponsors page renders from Supabase data
- [ ] Sponsor tier grouping works correctly
- [ ] Admin dashboard shows live sponsor count
- [ ] No TypeScript errors
- [ ] `npm run build` succeeds
- [ ] Phase 11 complete — sponsors fully managed through admin
</verification>

<success_criteria>

- Public sponsors page reads from Supabase (not static data)
- Admin dashboard shows live sponsor count from database
- Sponsor levels/tiers static content preserved
- Error-resilient pattern with Array.isArray() guard
- Empty state displays when no sponsors exist
- Phase 11 complete
</success_criteria>

<output>
After completion, create `.planning/phases/11-sponsor-management/11-03-SUMMARY.md`
</output>

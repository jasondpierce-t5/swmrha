---
phase: 09-authentication-admin-foundation
plan: 02
type: execute
depends_on: ["09-01"]
files_modified: [src/app/login/page.tsx, src/app/unauthorized/page.tsx, src/app/admin/logout/route.ts]
---

<objective>
Build login page with email/password auth form and supporting auth UI (unauthorized page, logout handler).

Purpose: Provide the entry point for admin authentication — a polished login form matching the dark western aesthetic that non-technical board members can use confidently.
Output: Login page, unauthorized page, server-side logout route handler.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-authentication-admin-foundation/09-CONTEXT.md
@.planning/phases/09-authentication-admin-foundation/09-01-SUMMARY.md

# Key files:
@src/app/globals.css
@src/app/layout.tsx
@src/lib/supabase/client.ts
@src/lib/supabase/server.ts

**Tech stack available:** Next.js 16.1.6, React 19, Tailwind CSS v4, @supabase/supabase-js, @supabase/ssr, @heroicons/react
**Established patterns:** Dark western theme (navy-900 bg, gold-500 accents, Montserrat headings, Inter body), App Router pages
**Constraining decisions:**
- 09-CONTEXT: Same dark western aesthetic as public site — cohesive branding
- 09-CONTEXT: Non-technical board members must navigate confidently
- 09-01: Supabase browser client via createBrowserClient for client components
- 09-01: Supabase server client for server-side operations
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create login page with email/password form</name>
  <files>src/app/login/page.tsx</files>
  <action>
Create src/app/login/page.tsx as a Client Component ("use client"):

Design:
- Full-page centered layout with navy-900 background
- SWMRHA logo or text branding at top (use "SWMRHA" text with Montserrat heading font, gold-500 color)
- Subtitle: "Admin Login" in lighter text
- Card container with navy-800 background, rounded corners, subtle border (navy-700)
- Email input field with proper label, placeholder "admin@swmrha.com"
- Password input field with proper label, type="password"
- Sign In button: gold-500 background, navy-900 text, hover:gold-400, full-width
- Error message area (red-500 text below form) — displays Supabase auth errors in user-friendly language
- "Return to site" link below the card, linking to /

Functionality:
- Use useState for email, password, error, loading states
- On submit, create Supabase browser client and call supabase.auth.signInWithPassword({ email, password })
- On success, redirect to /admin using router.push('/admin') (useRouter from next/navigation)
- On error, display user-friendly error message (map Supabase error codes: "Invalid login credentials" → "Invalid email or password")
- Disable button during loading, show "Signing in..." text
- Form should prevent default submission
- Add keyboard accessibility — Enter key submits form

Do NOT add: password reset, sign up, OAuth buttons, remember me. This is admin-only with manually created accounts.
  </action>
  <verify>npm run build succeeds. Visit /login in browser — form renders with dark western styling. Attempting login with wrong credentials shows error message.</verify>
  <done>Login page renders with branded dark western design, submits credentials to Supabase, shows error on failure, redirects to /admin on success.</done>
</task>

<task type="auto">
  <name>Task 2: Create unauthorized page and logout handler</name>
  <files>src/app/unauthorized/page.tsx, src/app/admin/logout/route.ts</files>
  <action>
Create src/app/unauthorized/page.tsx (Server Component):
- Simple page matching dark western theme
- LockClosedIcon from @heroicons/react/24/outline at top (gold-500, w-16 h-16)
- Heading: "Access Denied"
- Message: "You don't have permission to access this area. This section is restricted to SWMRHA administrators."
- Two action links: "Go to Login" (link to /login) and "Return to Home" (link to /)
- Style links as buttons — gold-500 primary, navy-700 secondary

Create src/app/admin/logout/route.ts (Route Handler):
- Handle POST request
- Create Supabase server client
- Call supabase.auth.signOut()
- Redirect to /login using NextResponse.redirect
- Use request.nextUrl for proper URL construction

The logout is a POST route handler (not a page) for security — prevents CSRF via GET links. The admin layout will have a logout button that submits a form to this route.
  </action>
  <verify>npm run build succeeds. Visit /unauthorized — page renders with access denied message and navigation links. POST to /admin/logout redirects to /login.</verify>
  <done>Unauthorized page shows clear access denied message with navigation options. Logout route handler signs out and redirects to login.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Login page with email/password auth and supporting pages</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:3000/login
    3. Verify: Dark western themed login form with SWMRHA branding
    4. Test: Enter wrong credentials → should show "Invalid email or password" error
    5. Test: Enter valid admin credentials (from Supabase setup) → should redirect to /admin (will show 404 until Plan 09-03 builds the dashboard — that's expected)
    6. Visit: http://localhost:3000/unauthorized → should show access denied page
    7. Confirm: Public pages (/, /about, /shows) still work normally without any login requirement
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] /login page renders with dark western theme
- [ ] Login form submits to Supabase Auth
- [ ] Error handling shows user-friendly messages
- [ ] Successful login redirects to /admin
- [ ] /unauthorized page renders with clear messaging
- [ ] POST /admin/logout signs out and redirects
- [ ] npm run build succeeds
- [ ] Public pages unaffected
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Login flow works end-to-end with valid Supabase credentials
- No TypeScript errors
- Auth UI matches dark western aesthetic
</success_criteria>

<output>
After completion, create `.planning/phases/09-authentication-admin-foundation/09-02-SUMMARY.md`
</output>
